<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/
..\FrameXML\UI.xsd">
	<Script file="MailHelper.lua"/>	

	<Button name="MailHelperButtonTemplate" virtual="true">
		<Size>
			<AbsDimension x="120" y="14"/>
		</Size>
		<NormalFont inherits="GameFontNormal"/>
		<HighlightFont inherits="GameFontHighlight"/>
		<DisabledFont inherits="GameFontDisable"/>
		<HighlightTexture inherits="UIPanelButtonHighlightTexture"/>
	</Button>
	
	<!-- Создаем кнопку -->
	<Button
		name="MailHelper_SwitchShowButton"
		parent="MailFrame"
		inherits="UIPanelButtonTemplate"
		text="Mail Helper">
		<Size>
			<AbsDimension x="80" y="22"/>
		</Size>
		<Anchors>
			<Anchor
				point="BOTTOMRIGHT"
				relativeTo="MailFrame"
				relativePoint="BOTTOMRIGHT">
				<Offset>
					<AbsDimension x="-30" y="48"/>
				</Offset>
			</Anchor>
		</Anchors>
		<Scripts>
			<OnClick>
				MailHelper_SwitchShowMailHelperPanel();
			</OnClick>
			<OnLoad>
				this:SetFrameLevel(this:GetParent():GetFrameLevel() + 1);
			</OnLoad>
		</Scripts>
	</Button>

	<!-- Шаблон строки списка -->
	<Button name="MailHelper_ListRowTemplate" virtual="true" movable="true">
		<Size>
			<AbsDimension x="180" y="1"/>
		</Size>
		<Layers>
			<Layer level="ARTWORK">
				<FontString name="$parentText" inherits="GameFontNormal" justifyH="LEFT">
					<Anchors>
						<Anchor point="LEFT"><Offset><AbsDimension x="5" y="0"/></Offset></Anchor>
					</Anchors>
				</FontString>
			</Layer>
			<!-- Эффект наведения (подсветка) -->
			<Layer level="BACKGROUND">
				<Texture name="$parentHighlight" setAllPoints="true" hidden="true">
					<Color r="1" g="1" b="1" a="0.1"/>
				</Texture>
			</Layer>
		</Layers>
		<Scripts>
			<OnLoad>
				-- Регистрируем левую и ПРАВУЮ кнопки
				this:RegisterForClicks("LeftButtonUp", "RightButtonUp");
				
				-- Применяем высоту из нашей глобальной переменной
				if MailHelper and MailHelper.RowHeight then
					this:SetHeight(MailHelper.RowHeight);
				end
			</OnLoad>
			<OnEnter> getglobal(this:GetName().."Highlight"):Show(); </OnEnter>
			<OnLeave> getglobal(this:GetName().."Highlight"):Hide(); </OnLeave>
			<OnClick>
				MailHelper_ListRowClick();
			</OnClick>
		</Scripts>
	</Button>

	<!-- Основная панель -->
	<Frame
		name="MailHelperPanel"
		parent="MailFrame"
		toplevel="true"
		frameStrata="HIGH"
		movable="false"
		enableMouse="true" >
		<Size>
			<AbsDimension x="155" y="426"/>
		</Size>
		<Anchors>
			<Anchor point="TOPLEFT" relativeTo="MailFrame" relativePoint="TOPRIGHT">
				<Offset>
					<AbsDimension x="-27" y="-13"/> 
				</Offset>
			</Anchor>
		</Anchors>
		<Backdrop
			bgFile="Interface\DialogFrame\UI-DialogBox-Background"
			edgeFile="Interface\Tooltips\UI-Tooltip-Border"
			tile="true">
			<EdgeSize>
				<AbsValue val="16"/>
			</EdgeSize>
			<TileSize>
				<AbsValue val="16"/>
			</TileSize>
			<BackgroundInsets>
				<AbsInset left="5" right="5" top="5" bottom="5"/>
			</BackgroundInsets>
		</Backdrop>
		<Frames>
			<EditBox
				name="$parent_Input"
				inherits="InputBoxTemplate"
				autoFocus="false">
				<Size>
					<AbsDimension x="82" y="20"/>
				</Size>
				<Anchors>
					<Anchor point="TOPLEFT">
						<Offset>
							<AbsDimension x="13" y="-15"/>
						</Offset>
					</Anchor>
				</Anchors>
				<Scripts>
					<OnEnterPressed>
						MyAddTextToList();
					</OnEnterPressed>
				</Scripts>
			</EditBox>
			<Button 
				name="$parent_AddButton"
				inherits="UIPanelButtonTemplate"
				text="Add">
				<Size>
					<AbsDimension x="45" y="22"/>
				</Size>
				<Anchors>
					<Anchor point="LEFT" relativeTo="$parent_Input" relativePoint="RIGHT">
						<Offset>
							<AbsDimension x="3" y="0"/>
						</Offset>
					</Anchor>
				</Anchors>
				<Scripts>
					<OnClick>
						MyAddTextToList();
					</OnClick>
				</Scripts>
			</Button>
			
			<ScrollFrame
				name="$parent_ScrollFrame"
				inherits="UIPanelScrollFrameTemplate">
				<Size>
					<AbsDimension x="105" y="365"/>
				</Size>
				<Anchors>
					<Anchor point="TOPLEFT" relativeTo="$parent_Input" relativePoint="BOTTOMLEFT">
						<Offset>
							<AbsDimension x="0" y="-10"/>
						</Offset>
					</Anchor>
				</Anchors>
				<ScrollChild>
					<Frame name="$parent_ScrollContent">
						<Size>
							<AbsDimension x="105" y="355"/>
						</Size>
						<!-- Здесь будут создаваться строки -->
					</Frame>
				</ScrollChild>
			</ScrollFrame>
		</Frames>
		<Scripts>
			<OnShow>
				MailHelper_RefreshList();
			</OnShow>
		</Scripts>
	</Frame>
</Ui>